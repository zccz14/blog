---
title: RBAC 基于角色的访问控制
date: 2017-04-17
categories:
  - 系统分析
---

Role-Based Access Control, RBAC, 基于角色的访问控制。

根据[维基百科](https://en.wikipedia.org/wiki/Role-based_access_control)，RBAC 模型中通常包含主体(Subject)、角色(Role)、权限(Permission)这三种实体，以及主体指派 (Subject Assignment)，权限指派(Permission Assignment)，角色继承(Role Hierarchy)以及会话(Session) 这四种联系。

<!--more-->

首先分为 7 种对象。

+ S = **Subject** = A person or automated agent
+ R = **Role** = Job function or title which defines an authority level
+ P = **Permissions** = An approval of a mode of access to a resource
+ SE = **Session** = A mapping involving S, R and/or P
+ SA = **Subject Assignment**
+ PA = **Permission Assignment**
+ RH = Partially ordered **Role Hierarchy**. RH can also be written: ≥ (The notation: x ≥ y means that x inherits the permissions of y.)

它有几条基本规则：

1. Role assignment: A subject can exercise a permission only if the subject has selected or been assigned a role. 

   角色指派：只有当主体“**选中**”或“**被指派为**”一种角色后，才具有某种权限。

2. Role authorization: A subject's active role must be authorized for the subject. With rule 1 above, this rule ensures that users can take on only roles for which they are authorized. 

   角色验证：主体只能扮演被授予的有效角色，其他角色对这个主体来说是无效的，或者说不可用的。

3. Permission authorization: A subject can exercise a permission only if the permission is authorized for the subject's active role. With rules 1 and 2, this rule ensures that users can exercise only permissions for which they are authorized. 

   权限验证：只有当主体的某个有效角色被授予某种权限时，主体才能行使这个权限。

以下是一些补充说明。

+ A subject can have multiple roles.

+ A role can have multiple subjects.

  主体与角色是多对多关系。

+ A role can have many permissions.

+ A permission can be assigned to many roles.

  角色与权限是多对多关系。

+ An operation can be assigned many permissions.

+ A permission can be assigned to many operations.

  权限与操作是多对多关系。

多对多关系实际上如果要动态调整的话肯定是要建立一张中间表了。

然而实际上权限与操作的多对多关系并不建表。一般来说，操作与实现细节紧耦合，实际上可以将权限层硬编码到实现中，并不会使得系统变得混乱。

另外，Session 表示主体与系统的会话，通常是一次性的临时对象，每当结束会话（注销），就会被销毁。

> 注销实际上是销毁了系统中保存的会话（Session）。
>
> 但不同的系统对会话的概念不同，一般指从登录到登出之间。

Session 中需要保存主体，以及这次会话中具备的角色或权限。

一般而言 Session 相对于实体来说是比较轻量的，可能是主体的ID、角色的ID或者权限信息再加上一些状态量。